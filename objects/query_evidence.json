{
    "caption": "Query Evidence",
    "description": "The specific resulting evidence information that was queried or discovered. When mapping raw telemetry data users should select the appropriate child object that best matches the evidence type as defined by query_type_id.",
    "name": "query_evidence",
    "attributes": {
        "connection_info": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The network connection information related to a Network Connection query type."
        },
        "file": {
            "description": "The file that is the target of the query when query_type_id indicates a File query.",
            "group": "primary",
            "requirement": "recommended"
        },
        "folder": {
            "description": "The folder that is the target of the query when query_type_id indicates a Folder query.",
            "group": "primary",
            "requirement": "recommended"
        },
        "group": {
            "description": "The administrative group that is the target of the query when query_type_id indicates an Admin Group query.",
            "group": "primary",
            "requirement": "recommended"
        },
        "job": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The job object that pertains to the event when query_type_id indicates a Job query."
        },
        "kernel": {
            "description": "The kernel object that pertains to the event when query_type_id indicates a Kernel query.",
            "group": "primary",
            "requirement": "recommended"
        },
        "module": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The module that pertains to the event when query_type_id indicates a Module query."
        },
        "network_interfaces": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The physical or virtual network interfaces that are associated with the device when query_type_id indicates a Network Interfaces query."
        },
        "peripheral_device": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The peripheral device that triggered the event when query_type_id indicates a Peripheral Device query."
        },
        "process": {
            "description": "The process that pertains to the event when query_type_id indicates a Process query.",
            "group": "primary",
            "requirement": "recommended"
        },
        "service": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The service that pertains to the event when query_type_id indicates a Service query."
        },
        "session": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The authenticated user or service session when query_type_id indicates a Session query."
        },
        "startup_item": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The startup item object that pertains to the event when query_type_id indicates a Startup Item query."
        },
        "state": {
            "caption": "Network Connection State",
            "description": "The state of the socket, normalized to the caption of the state_id value. In the case of 'Other', it is defined by the event source.",
            "group": "context",
            "requirement": "optional"
        },
        "state_id": {
            "caption": "Network Connection State ID",
            "description": "The state of the socket.",
            "group": "context",
            "requirement": "optional",
            "enum": {
                "0": {
                    "caption": "Unknown",
                    "description": "The socket state is unknown."
                },
                "1": {
                    "caption": "ESTABLISHED",
                    "description": "The socket has an established connection between a local application and a remote peer."
                },
                "2": {
                    "caption": "SYN_SENT",
                    "description": "The socket is actively trying to establish a connection to a remote peer."
                },
                "3": {
                    "caption": "SYN_RECV",
                    "description": "The socket has passively received a connection request from a remote peer."
                },
                "4": {
                    "caption": "FIN_WAIT1",
                    "description": "The socket connection has been closed by the local application, the remote peer has not yet acknowledged the close, and the system is waiting for it to close its half of the connection."
                },
                "5": {
                    "caption": "FIN_WAIT2",
                    "description": "The socket connection has been closed by the local application, the remote peer has acknowledged the close, and the system is waiting for it to close its half of the connection."
                },
                "6": {
                    "caption": "TIME_WAIT",
                    "description": "The socket connection has been closed by the local application, the remote peer has closed its half of the connection, and the system is waiting to be sure that the remote peer received the last acknowledgement."
                },
                "7": {
                    "caption": "CLOSED",
                    "description": "The socket is not in use."
                },
                "8": {
                    "caption": "CLOSE_WAIT",
                    "description": "The socket connection has been closed by the remote peer, and the system is waiting for the local application to close its half of the connection."
                },
                "9": {
                    "caption": "LAST_ACK",
                    "description": "The socket connection has been closed by the remote peer, the local application has closed its half of the connection, and the system is waiting for the remote peer to acknowledge the close."
                },
                "10": {
                    "caption": "LISTEN",
                    "description": "The socket is listening for incoming connections."
                },
                "11": {
                    "caption": "CLOSING",
                    "description": "The socket connection has been closed by the local application and the remote peer simultaneously, and the remote peer has not yet acknowledged the close attempt of the local application."
                }
            }
        },
        "user": {
            "group": "primary",
            "requirement": "recommended",
            "description": "The user that pertains to the event when query_type_id indicates a User query."
        },
        "users": {
            "description": "The users that belong to the administrative group when query_type_id indicates a Users query.",
            "group": "context",
            "requirement": "optional"
        },
        "query_type_id": {
            "caption": "Query Type ID",
            "description": "The normalized type of system query performed against a device or system component.",
            "sibling": "query_type",
            "group": "classification",
            "requirement": "required",
            "type": "integer_t",
            "enum": {
                "0": {
                    "caption": "Unknown",
                    "description": "The query type was unknown or not specified."
                },
                "1": {
                    "caption": "Kernel",
                    "description": "A query about kernel resources including system calls, shared mutex, or other kernel components."
                },
                "2": {
                    "caption": "File",
                    "description": "A query about file attributes, metadata, content, hash values, or properties."
                },
                "3": {
                    "caption": "Folder",
                    "description": "A query about folder attributes, metadata, content, or structure."
                },
                "4": {
                    "caption": "Admin Group",
                    "description": "A query about group membership, privileges, domain, or group properties."
                },
                "5": {
                    "caption": "Job",
                    "description": "A query about scheduled jobs, their command lines, run states, or execution times."
                },
                "6": {
                    "caption": "Module",
                    "description": "A query about loaded modules, their base addresses, load types, or function entry points."
                },
                "7": {
                    "caption": "Network Connection",
                    "description": "A query about active network connections, boundaries, protocols, or TCP states."
                },
                "8": {
                    "caption": "Network Interfaces",
                    "description": "A query about physical or virtual network interfaces, their IP/MAC addresses, or types."
                },
                "9": {
                    "caption": "Peripheral Device",
                    "description": "A query about attached peripheral devices, their classes, models, or vendor information."
                },
                "10": {
                    "caption": "Process",
                    "description": "A query about running processes, command lines, ancestry, loaded modules, or execution context."
                },
                "11": {
                    "caption": "Service",
                    "description": "A query about system services, their names, versions, labels, or properties."
                },
                "12": {
                    "caption": "Session",
                    "description": "A query about authenticated user or service sessions, their creation times, or issuer details."
                },
                "13": {
                    "caption": "User",
                    "description": "A query about user accounts, their properties, credentials, or domain information."
                },
                "14": {
                    "caption": "Users",
                    "description": "A query about multiple users belonging to an administrative group."
                },
                "15": {
                    "caption": "Startup Item",
                    "description": "A query about startup configuration items, their run modes, start types, or current states."
                },
                "16": {
                    "caption": "Registry Key",
                    "description": "A Windows-specific query about registry keys, their paths, security descriptors, or modification times."
                },
                "17": {
                    "caption": "Registry Value",
                    "description": "A Windows-specific query about registry values, their data types, content, or names."
                },
                "18": {
                    "caption": "Prefetch",
                    "description": "A Windows-specific query about prefetch files, their run counts, last execution times, or existence."
                },
                "99": {
                    "caption": "Other",
                    "description": "The query type was not mapped to a standard category. See the query_type attribute for source-specific value."
                }
            }
        },
        "query_type": {
            "caption": "Query Type",
            "description": "The normalized caption of query_type_id or the source-specific query type.",
            "group": "classification",
            "requirement": "optional",
            "type": "string_t"
        }
    },
    "constraints": {
        "just_one": [
            "connection_info",
            "file",
            "folder",
            "group",
            "job",
            "kernel",
            "module",
            "network_interfaces",
            "peripheral_device",
            "process",
            "service",
            "session",
            "startup_item",
            "user"
        ]
    }
}
